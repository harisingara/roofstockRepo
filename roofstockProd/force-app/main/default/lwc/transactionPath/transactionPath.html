<template>

    <!--to create Mark current status button including refresh-->
    <!--div class="slds-grid slds-path__action slds-float_right">
        <lightning-button class="slds-path__mark-complete slds-no-flex slds-m-horizontal__medium slds-p-around_small"
            variant="brand" onclick={updateCurrentMilestone} label='Mark Current Status'>
        </lightning-button>
    </div-->
  
    <!--to display milestones on path-->
    <template if:true={isAcquisitionBuy}>

        <div class="slds-var-p-around_small">
            <lightning-progress-indicator current-step={currentpath} type="path" variant="base">
                <template for:each={transactionMilesoneStatusValues} for:item="step">
                    <lightning-progress-step label={step.label} value={step.value} key={step.label}
                        onstepfocus={handleStepBlur}>
                        <!--to display the name of the path-->
                    </lightning-progress-step>

                </template>
            </lightning-progress-indicator>
        </div>

        <div>
            <lightning-tabset variant="scoped" active-tab-value="Contract_QC">

                <template for:each={typeOptions} for:item="tab">
                    <lightning-tab label={tab.label} key={tab.value} value={tab.value} onactive={handleTypeChange}>

                        <template if:true={isContractQC}>
                            <!-- error handling -->
                            <template if:true={displayError}>
                                <div class="slds-notify slds-notify_alert slds-theme_alert-texture slds-theme_error" role="alert">
                                    <span class="slds-icon_container slds-icon-utility-error slds-var-m-right_x-small" title="Description of icon when needed">
                                        <lightning-icon icon-name="utility:error" alternative-text="Error" title="Error" variant="inverse"></lightning-icon>
                                    </span>
                                    <h2>{errorMessage}</h2>
                                </div>
                            </template>                            

                            <!--view mode, cancel & save button-->
                            <template if:false={hideButtons}>
                                <div class="slds-grid slds-path__action slds-align_absolute-center">
                                    <lightning-button label="Cancel" onclick={changeMode} class="slds-var-p-around_small" if:false={isReadMode}>
                                    </lightning-button>
                                    <lightning-button label="Update" onclick={handleUpdate} class="slds-var-p-around_small" type="submit" 
                                        variant="brand" if:false={isReadMode}>
                                    </lightning-button>
                                    <lightning-button label="Update & Send Email" onclick={handleSubmit} class="slds-var-p-around_small" type="submit" 
                                        variant="brand" if:false={isReadMode}>
                                    </lightning-button>
                                    <lightning-button label="Edit" onclick={changeMode} class="slds-var-p-around_small" if:true={isReadMode}>
                                        </lightning-button>   
                                                                    
                                    <template if:true={isTaskCompleted}>
                                        <lightning-button label="Verified" class="slds-var-p-around_small" type="submit" if:true={isReadMode} variant="success">
                                        </lightning-button>
                                    </template>
                                    <template if:false={isTaskCompleted}>
                                        <lightning-button label="Verify" class="slds-var-p-around_small" type="submit" onclick={saveTask} if:true={isReadMode} variant="success">
                                        </lightning-button>
                                    </template>
                                </div>
                            </template>

                            <!-- Contract QC Page -->

                        <lightning-accordion allow-multiple-sections-open active-section-name={activeSections}>

                            <!-- Files Section -->
                            <lightning-accordion-section name="Files" label="Acquisition Kickoff Resources">
                                <lightning-layout>
                                    <template for:each={FileWrapper} for:item="fileswarp">
                                        <lightning-layout-item padding="around-small" size="12" key={fileswarp}>
                                            <div>
                                                <table class="slds-table slds-table_cell-buffer slds-table_fixed-layout slds-max-medium-table_stacked-horizontal slds-table_bordered">
                                                    <thead>
                                                        <tr class="slds-line-height_reset">
                                                            <th class="slds-size_3-of-12" scope="col">
                                                                <div>Type</div>
                                                            </th>
                                                            <th class="slds-size_3-of-12" scope="col">
                                                                <div>File Name</div>
                                                            </th>
                                                            <th class ="slds-size_1-of-12" scope="col">
                                                                <div>Size</div>
                                                            </th>
                                                            <th class="slds-size_1-of-12" scope="col">
                                                                <div>Date</div>
                                                            </th>
                                                            <th class="slds-size_2-of-12" scope="col">
                                                                <div>Uploaded By</div>
                                                            </th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <template for:each={fileswarp.entity} for:item="warp" for:index="index">
                                                            <tr class="slds-line-height_reset" key={wrap}>
                                                                <td class="slds-cell-wrap slds-size_3-of-12">
                                                                    <div>{warp.type}</div>
                                                                </td>
                                                                <td class="slds-cell-wrap slds-size_3-of-12">
                                                                    <div>
                                                                        <lightning-formatted-url value={warp.uri}
                                                                            label={warp.fileName} target="_blank">
                                                                        </lightning-formatted-url>
                                                                    </div>
                                                                </td>
                                                                <td class="slds-cell-wrap slds-size_1-of-12">
                                                                    <div>{warp.sizeInByte}</div>
                                                                </td>
                                                                <td class="slds-cell-wrap slds-size_1-of-12">
                                                                    <div>{warp.uploadedOnUtc}</div>
                                                                </td>
                                                                <td class="slds-cell-wrap slds-size_2-of-12">
                                                                    <div>{warp.uploadedBy}</div>
                                                                </td>
                                                            </tr>
                                                        </template>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </lightning-layout-item>
                                    </template>
                                </lightning-layout>
                            </lightning-accordion-section>

                            <!--fields-->
                            <lightning-layout>
                                <lightning-layout-item padding="around-small" size="5">
                                    <table class="slds-table slds-table_cell-buffer">	
                                        <thead>
                                                <tr class="slds-line-height_reset">
                                                    <th class="" scope="col">
                                                        <div>Fields</div>
                                                    </th>
                                                    <th class="" scope="col">
                                                        <div>To Verify</div>
                                                    </th>
                                                </tr>
                                            </thead>
                                        <tbody>

                                            <template if:true={displayOffMarket}> 
                                                <!-- Assignment Fee -->                                    
                                                <tr class="slds-line-height_reset">
                                                    <td>
                                                        <lightning-layout-item size="4" padding="around-none">
                                                            <div class="slds-form-element">
                                                                <span class="slds-form-element__label">Assignment Fee?</span>
                                                            </div>
                                                        </lightning-layout-item>
                                                    </td>
                                                    <td>
                                                        <lightning-layout-item size="4" padding="around-none">
                                                            <lightning-input name="Assignment_Fee__c"
                                                                data-field="transactionRecord.Assignment_Fee__c" type="number"
                                                                label="" formatter="currency" step="0.01"
                                                                value={contractQCWrapper.transactionRecord.Assignment_Fee__c}
                                                                onchange={handleFieldChange} if:false={isReadMode}>
                                                            </lightning-input>
                                                            <!--readonly-->
                                                                <lightning-input name="Assignment_Fee__c_ro"
                                                                data-field="transactionRecord.Assignment_Fee__c_ro" type="number"
                                                                label="" formatter="currency" step="0.01"
                                                                value={contractQCWrapper.transactionRecord.Assignment_Fee__c} disabled onchange={handleFieldChange} if:true={isReadMode}>
                                                            </lightning-input>
                                                            </lightning-layout-item>   
                                                    </td>
                                                </tr>

                                                <!-- Buyer Paid Commission -->                                    
                                                <tr class="slds-line-height_reset">
                                                    <td>
                                                        <lightning-layout-item size="4" padding="around-none">
                                                            <div class="slds-form-element">
                                                                <span class="slds-form-element__label">Buyer Paid Commission?</span>
                                                            </div>
                                                        </lightning-layout-item>
                                                    </td>
                                                    <td>
                                                        <lightning-layout-item size="4" padding="around-none">
                                                            <lightning-input name="Buyer_Commission_Percent__c"
                                                                data-field="transactionRecord.Buyer_Commission_Percent__c" type="number"
                                                                label="" formatter="percent-fixed" step="0.01"
                                                                value={contractQCWrapper.transactionRecord.Buyer_Commission_Percent__c}
                                                                onchange={handleFieldChange} if:false={isReadMode}>
                                                            </lightning-input>
                                                            <!--readonly-->
                                                                <lightning-input name="Buyer_Commission_Percent__c_ro"
                                                                data-field="transactionRecord.Buyer_Commission_Percent__c_ro" type="number"
                                                                label="" formatter="percent-fixed" step="0.01"
                                                                value={contractQCWrapper.transactionRecord.Buyer_Commission_Percent__c} disabled onchange={handleFieldChange} if:true={isReadMode}>
                                                            </lightning-input>
                                                            </lightning-layout-item>   
                                                    </td>
                                                </tr>
                                            </template>    
                                            <!-- Buyer Entity -->
                                            <tr class="slds-line-height_reset">
                                                <td>
                                                    <lightning-layout-item size="4" padding="around-none">
                                                        <div class="slds-form-element">
                                                            <span class="slds-form-element__label">Buyer Entity</span>
                                                        </div>
                                                    </lightning-layout-item>
                                                </td>
                                                <td>
                                                    <lightning-layout-item size="4" padding="around-none">
                                                        <lightning-combobox name="Buyer_Entity__c"
                                                            data-field="transactionRecord.Buyer_Entity__c" label=""
                                                            value={contractQCWrapper.transactionRecord.Buyer_Entity__c}
                                                            placeholder="Select Buyer Entity"
                                                            options={buyerEntityDropdownValues} onchange={handleFieldChange} if:false={isReadMode}>
                                                        </lightning-combobox>
                                                        <!--readonly-->
                                                            <lightning-combobox name="Buyer_Entity__c_ro"
                                                            data-field="transactionRecord.Buyer_Entity__c_ro" label=""
                                                            value={contractQCWrapper.transactionRecord.Buyer_Entity__c}
                                                            placeholder="Select Buyer Entity"
                                                            options={buyerEntityDropdownValues} readonly onchange={handleFieldChange} if:true={isReadMode}>
                                                        </lightning-combobox>
                                                    </lightning-layout-item>
                                                </td>
                                            </tr>
                                            <!-- Contract Price -->                                    
                                            <tr class="slds-line-height_reset">
                                                <td>
                                                    <lightning-layout-item size="4" padding="around-none">
                                                        <div class="slds-form-element">
                                                            <span class="slds-form-element__label">Contract Price</span>
                                                        </div>
                                                    </lightning-layout-item>
                                                </td>
                                                <td>
                                                    <lightning-layout-item size="4" padding="around-none">
                                                        <lightning-input name="In_Contract_Price__c"
                                                            data-field="transactionRecord.In_Contract_Price__c" type="number"
                                                            label="" formatter="currency" step="0.01"
                                                            value={contractQCWrapper.transactionRecord.In_Contract_Price__c} 
                                                            onchange={handleFieldChange} if:false={isReadMode}>
                                                        </lightning-input>
                                                        <!--readonly-->
                                                            <lightning-input name="In_Contract_Price__c_ro"
                                                            data-field="transactionRecord.In_Contract_Price__c_ro" type="number"
                                                            label="" formatter="currency" step="0.01"
                                                            value={contractQCWrapper.transactionRecord.In_Contract_Price__c} disabled onchange={handleFieldChange} if:true={isReadMode}>
                                                        </lightning-input>
                                                        </lightning-layout-item>   
                                                </td>
                                            </tr>
                                            <!-- Contract Date -->
                                            <tr class="slds-line-height_reset">
                                                <td>
                                                    <lightning-layout-item size="4" padding="around-none">
                                                        <div class="slds-form-element">
                                                            <span class="slds-form-element__label">Contract Date</span>
                                                        </div>
                                                    </lightning-layout-item>
                                                </td>
                                                <td>
                                                    <lightning-layout-item size="4" padding="around-none">
                                                        <lightning-input name="In_Contract_Date__c"
                                                            data-field="transactionRecord.In_Contract_Date__c" type="date"
                                                            label="" date-style="short"
                                                            value={contractQCWrapper.transactionRecord.In_Contract_Date__c}
                                                            onchange={handleFieldChange} if:false={isReadMode}>
                                                        </lightning-input>
                                                        <!--readonly-->
                                                        <lightning-input name="In_Contract_Date__c_ro"
                                                            data-field="transactionRecord.In_Contract_Date__c_ro" type="date"
                                                            label="" date-style="short" disabled 
                                                            value={contractQCWrapper.transactionRecord.In_Contract_Date__c}
                                                            onchange={handleFieldChange} if:true={isReadMode}>
                                                        </lightning-input>
                                                    </lightning-layout-item>
                                                </td>
                                            </tr>
                                            <!-- EMD Amount -->                                    
                                            <tr class="slds-line-height_reset">
                                                <td>
                                                    <lightning-layout-item size="4" padding="around-none">
                                                        <div class="slds-form-element">
                                                            <span class="slds-form-element__label">EMD Amount</span>
                                                        </div>
                                                    </lightning-layout-item>
                                                </td>
                                                <td>
                                                    <lightning-layout-item size="4" padding="around-none">
                                                        <lightning-input name="emdAmount"
                                                            data-field="emdAmount.Unit_Price__c" type="number"
                                                            label="" formatter="currency" step="0.01"
                                                            value={contractQCWrapper.emdAmount.Unit_Price__c}
                                                            onchange={handleFieldChange} if:false={isReadMode}>
                                                        </lightning-input>
                                                        <!--readonly-->
                                                        <lightning-input name="emdAmount_ro"
                                                            data-field="emdAmount.Unit_Price__c_ro" type="number"
                                                            label="" formatter="currency" step="0.01" disabled="true"
                                                            value={contractQCWrapper.emdAmount.Unit_Price__c}
                                                            onchange={handleFieldChange} if:true={isReadMode}>
                                                        </lightning-input>
                                                    </lightning-layout-item>
                                                </td>
                                            </tr>
                                            <!-- EMD Due Date -->
                                            <tr class="slds-line-height_reset">
                                                <td>
                                                    <lightning-layout-item size="4" padding="around-none">
                                                        <div class="slds-form-element">
                                                            <span class="slds-form-element__label">EMD Due Date</span>
                                                        </div>
                                                    </lightning-layout-item>
                                                </td>
                                                <td>
                                                    <lightning-layout-item size="4" padding="around-none">
                                                        <lightning-input name="EMD_Due_Date__c"
                                                            data-field="transactionRecord.EMD_Due_Date__c" type="date"
                                                            label="" date-style="short"
                                                            value={contractQCWrapper.transactionRecord.EMD_Due_Date__c}
                                                            onchange={handleFieldChange} if:false={isReadMode}>
                                                        </lightning-input>
                                                        <!--readonly-->
                                                        <lightning-input name="EMD_Due_Date__c_ro"
                                                            data-field="transactionRecord.EMD_Due_Date__c_ro" type="date"
                                                            label="" date-style="short" disabled
                                                            value={contractQCWrapper.transactionRecord.EMD_Due_Date__c}
                                                            onchange={handleFieldChange} if:true={isReadMode}>
                                                        </lightning-input>
                                                    </lightning-layout-item>
                                                </td>
                                            </tr>                                            
                                            <!-- Option Fee Amount -->
                                            <template if:true={displayOptionFee}> 
                                                <tr class="slds-line-height_reset">
                                                    <td>
                                                        <lightning-layout-item size="4" padding="around-none">
                                                            <div class="slds-form-element">
                                                                <span class="slds-form-element__label">Option Fee Amount</span>
                                                            </div>
                                                        </lightning-layout-item>
                                                    </td>
                                                    <td>
                                                        <lightning-layout-item size="4" padding="around-none">
                                                            <lightning-input name="optionFeeAmount"
                                                                data-field="optionFeeAmount.Unit_Price__c" type="number"
                                                                label="" formatter="currency" step="0.01"
                                                                value={contractQCWrapper.optionFeeAmount.Unit_Price__c}
                                                                onchange={handleFieldChange} if:false={isReadMode} >
                                                            </lightning-input>
                                                            <!--readonly-->
                                                            <lightning-input name="optionFeeAmount_ro"
                                                            data-field="optionFeeAmount.Unit_Price__c_ro" type="number"
                                                            label="" formatter="currency" step="0.01" disabled="true"
                                                            value={contractQCWrapper.optionFeeAmount.Unit_Price__c}
                                                            onchange={handleFieldChange} if:true={isReadMode} >
                                                        </lightning-input>
                                                        </lightning-layout-item>
                                                    </td>
                                                </tr>
                                            </template>
                                            <!-- Diligence End Date -->
                                            <tr class="slds-line-height_reset">
                                                <td>
                                                    <lightning-layout-item size="4" padding="around-none">
                                                        <div class="slds-form-element">
                                                            <span class="slds-form-element__label">Diligence End Date</span>
                                                        </div>
                                                    </lightning-layout-item>
                                                </td>
                                                <td>
                                                    <lightning-layout-item size="4" padding="around-none">
                                                        <lightning-input name="Date_Contingencies_Lift__c"
                                                            data-field="transactionRecord.Date_Contingencies_Lift__c" type="date"
                                                            label="" date-style="short"
                                                            value={contractQCWrapper.transactionRecord.Date_Contingencies_Lift__c}
                                                            onchange={handleFieldChange} if:false={isReadMode}>
                                                        </lightning-input>
                                                        <!--readonly-->
                                                        <lightning-input name="Date_Contingencies_Lift__c_ro"
                                                        data-field="transactionRecord.Date_Contingencies_Lift__c_ro" type="date"
                                                        label="" date-style="short" disabled
                                                        value={contractQCWrapper.transactionRecord.Date_Contingencies_Lift__c}
                                                        onchange={handleFieldChange} if:true={isReadMode}>
                                                    </lightning-input>
                                                    </lightning-layout-item>
                                                </td>
                                            </tr>
                                            <!-- Inspection Deadline -->
                                            <tr class="slds-line-height_reset">
                                                <td>
                                                    <lightning-layout-item size="4" padding="around-none">
                                                        <div class="slds-form-element">
                                                            <span class="slds-form-element__label">Inspection Deadline</span>
                                                        </div>
                                                    </lightning-layout-item>
                                                </td>
                                                <td>
                                                    <lightning-layout-item size="4" padding="around-none">
                                                        <lightning-input name="Inspection_Due_Date__c"
                                                            data-field="transactionRecord.Inspection_Due_Date__c" type="date"
                                                            label="" date-style="short"
                                                            value={contractQCWrapper.transactionRecord.Inspection_Due_Date__c}
                                                            onchange={handleFieldChange} if:false={isReadMode}>
                                                        </lightning-input>
                                                        <!--readonly-->
                                                        <lightning-input name="Inspection_Due_Date__c_ro"
                                                            data-field="transactionRecord.Inspection_Due_Date__c_ro" type="date"
                                                            label="" date-style="short" disabled
                                                            value={contractQCWrapper.transactionRecord.Inspection_Due_Date__c}
                                                            onchange={handleFieldChange} if:true={isReadMode}>
                                                        </lightning-input>
                                                    </lightning-layout-item>
                                                </td>
                                            </tr>
                                            <!-- Estimate Closing Date -->
                                            <tr class="slds-line-height_reset">
                                                <td>
                                                    <lightning-layout-item size="4" padding="around-none">
                                                        <div class="slds-form-element">
                                                            <span class="slds-form-element__label">Est Closing Date</span>
                                                        </div>
                                                    </lightning-layout-item>
                                                </td>
                                                <td>
                                                    <lightning-layout-item size="4" padding="around-none">
                                                        <lightning-input name="Est_Close_Date__c"
                                                            data-field="transactionRecord.Est_Close_Date__c" type="date"
                                                            label="" date-style="short"
                                                            value={contractQCWrapper.transactionRecord.Est_Close_Date__c}
                                                            onchange={handleFieldChange} if:false={isReadMode}>
                                                        </lightning-input>
                                                        <!--readonly-->
                                                        <lightning-input name="Est_Close_Date__c_ro"
                                                            data-field="transactionRecord.Est_Close_Date__c_ro" type="date"
                                                            label="" date-style="short" disabled
                                                            value={contractQCWrapper.transactionRecord.Est_Close_Date__c}
                                                            onchange={handleFieldChange} if:true={isReadMode}>
                                                        </lightning-input>
                                                    </lightning-layout-item>
                                                </td>
                                            </tr>
                                            <!-- HOA -->
                                            <tr class="slds-line-height_reset">
                                                <td>
                                                    <lightning-layout-item size="4" padding="around-none">
                                                        <div class="slds-form-element">
                                                            <span class="slds-form-element__label">HOA</span>
                                                        </div>
                                                    </lightning-layout-item>
                                                </td>
                                                <td>
                                                    <lightning-layout-item size="4" padding="around-large">		
                                                        <template if:true={contractQCWrapper.propertyRecord.HOA__c}>
                                                            <lightning-input type="checkbox" name="HOA__c" value={contractQCWrapper.propertyRecord.HOA__c} 
                                                            data-field="propertyRecord.HOA__c" onchange={handleFieldChange} if:false={isReadMode} checked></lightning-input>
                                                        </template>
                                                        <template if:false={contractQCWrapper.propertyRecord.HOA__c}>
                                                            <lightning-input type="checkbox"  name="HOA__c" value={contractQCWrapper.propertyRecord.HOA__c} 
                                                            data-field="propertyRecord.HOA__c" onchange={handleFieldChange} if:false={isReadMode}></lightning-input>
                                                        </template> 
                                                        <!--readonly-->
                                                        <template if:true={contractQCWrapper.propertyRecord.HOA__c}>
                                                            <lightning-input type="checkbox" name="HOA__c_ro" value={contractQCWrapper.propertyRecord.HOA__c} 
                                                            data-field="propertyRecord.HOA___ro" disabled="true" onchange={handleFieldChange} if:true={isReadMode} checked></lightning-input>
                                                        </template>
                                                        <template if:false={contractQCWrapper.propertyRecord.HOA__c}>
                                                            <lightning-input type="checkbox" name="HOA__c_ro" value={contractQCWrapper.propertyRecord.HOA__c} 
                                                            data-field="propertyRecord.HOA__c_ro" disabled="true" onchange={handleFieldChange} if:true={isReadMode}></lightning-input>
                                                        </template> 	
                                                    </lightning-layout-item>
                                                </td>
                                            </tr>                           
                                            <!-- Title Company -->                                                          
                                            <tr class="slds-line-height_reset">
                                                <td>
                                                    <lightning-layout-item size="4" padding="around-none">
                                                        <div class="slds-form-element">
                                                            <span class="slds-form-element__label">Title Company</span>
                                                        </div>
                                                    </lightning-layout-item>
                                                </td>
                                                <td>
                                                    <lightning-layout-item size="4" padding="around-none">
                                                        <c-custom-lookup-lwc icon-name="standard:account"
                                                            name="Title_Company_Account__c"
                                                            data-field="transactionRecord.Title_Company_Account__c"                                            
                                                            s-object-api-name="account"
                                                            s-filter-object-field-api-name="RecordTypeId"      
                                                            s-filter-object-record-id={contractQCWrapper.titleAccountRecordTypeId}
                                                            label=""
                                                            onlookupupdate={lookupRecord}
                                                            default-record-id={contractQCWrapper.transactionRecord.Title_Company_Account__c}
                                                            placeholder="type here..." if:false={isReadMode}>
                                                        </c-custom-lookup-lwc>
                                                        <!--readonly-->
                                                        <lightning-input disabled 
                                                            value={contractQCWrapper.titleCompanyContactAccountName} if:true={isReadMode}>
                                                        </lightning-input>
                                                    </lightning-layout-item>                                                    
                                                </td>
                                            </tr>
                                            <!-- Title Company Contact -->                                                          
                                            <tr class="slds-line-height_reset">
                                                <td>
                                                    <lightning-layout-item size="4" padding="around-none">
                                                        <div class="slds-form-element">
                                                            <span class="slds-form-element__label">Title Company Contact</span>
                                                        </div>
                                                    </lightning-layout-item>
                                                </td>
                                                <td>
                                                    <lightning-layout-item size="4" padding="around-none">
                                                        <c-custom-lookup-lwc icon-name="standard:contact"
                                                            name="titleCompanyContact"
                                                            data-field="titleCompanyContact.Contact__c"                                            
                                                            s-object-api-name="contact"
                                                            s-filter-object-field-api-name="AccountId"      
                                                            s-filter-object-record-id={contactFilterByAccountId}      
                                                            label=""
                                                            onlookupupdate={lookupRecord}
                                                            default-record-id={contractQCWrapper.titleCompanyContact.Contact__c}
                                                            placeholder="type here..." if:false={isReadMode}>
                                                        </c-custom-lookup-lwc>
                                                        <lightning-input disabled 
                                                            value={contractQCWrapper.titleContact.Name} if:true={isReadMode}>
                                                        </lightning-input>
                                                    </lightning-layout-item>                                                    
                                                </td>
                                            </tr>                                            
                                            <!-- Occupancy Status -->   
                                            <template for:each={contractQCWrapper.propertyUnitList} for:item="propertyUnit" for:index="index">     
                                                <tr class="slds-line-height_reset" key={propertyUnit.Id}>
                                                    <td>
                                                        <lightning-layout-item size="4" padding="around-none">
                                                            <div class="slds-form-element">
                                                                <span class="slds-form-element__label">Occupancy Status {propertyUnit.HomeCode__c}</span>
                                                            </div>
                                                        </lightning-layout-item>
                                                    </td>
                                                    <td>
                                                        <lightning-layout-item size="4" padding="around-none">	
                                                            <lightning-combobox
                                                                name="Occupancy_at_Closing__c"
                                                                if:false={isReadMode}
                                                                data-field={index}                                                                
                                                                value={propertyUnit.Occupancy_at_Closing__c}
                                                                placeholder="Select Occupancy"
                                                                options={occupancyPicklistValues}
                                                                onchange={handleFieldChange} label="">
                                                            </lightning-combobox>
                                                            <!-- readonly -->
                                                            <lightning-combobox
                                                                name="Occupancy_at_Closing__c"
                                                                if:true={isReadMode}
                                                                readonly
                                                                data-field={index}                                                                
                                                                value={propertyUnit.Occupancy_at_Closing__c}
                                                                placeholder="Select Occupancy"
                                                                options={occupancyPicklistValues}
                                                                onchange={handleFieldChange} label="">
                                                            </lightning-combobox>
                                                        </lightning-layout-item> 
                                                    </td>
                                                </tr> 
                                            </template>                                               
                                        </tbody>
                                    </table>
                                </lightning-layout-item>
                                <template if:false={isDefaultChecklist}>
                                    <lightning-layout-item padding="around-small" size="7">
                                        <div>
                                            <table class="slds-table slds-table_cell-buffer">
                                                <thead>
                                                    <tr class="slds-line-height_reset">
                                                        <th class="" scope="col">
                                                            <div>Original Entry</div>
                                                        </th>
                                                        <th class="" scope="col">
                                                            <div>Audited Info</div>
                                                        </th>
                                                        <th class="" scope="col">
                                                            <div>Verify</div>
                                                        </th>
                                                        <th class="slds-col slds-grow-none slds-hidden"  scope="col">
                                                            <div>Review Type</div>
                                                        </th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <template if:true={lstReviewItems}>
                                                        <template for:each={lstReviewItems}
                                                            for:item="review" for:index="index">
                                                            <tr class="slds-line-height_reset" key={review.Review_Checklist_Type__c}>
                                                                <td>
                                                                    <lightning-layout-item size="3" padding="around-none">
                                                                        <lightning-input  name="review.Original_Broker_Entry__c"
                                                                        value={review.Original_Broker_Entry__c} disabled type="text" label=""
                                                                        data-field={index}></lightning-input>
                                                                    </lightning-layout-item>                                                                    
                                                                </td>
                                                                <td>
                                                                    <lightning-layout-item size="3" padding="around-none">
                                                                        <lightning-input name="review.TC_Updates__c" value={review.TC_Updates__c} class="TC_Updates__c"
                                                                        disabled type="text" label="" data-field={index} onchange={handleFieldChange}></lightning-input>
                                                                    </lightning-layout-item>                                                                    
                                                                </td>
                                                                <td>
                                                                    <!-- Verify -->
                                                                    <lightning-layout-item size="2" padding="around-none">
                                                                        <template if:true={review.Verify__c}>
                                                                            <lightning-input type="checkbox" name="review.Verify__c" value={review.Verify__c} label="" checked data-field={index} onchange={handleFieldChange} if:false={isReadMode}></lightning-input>
                                                                        </template>
                                                                        <template if:false={review.Verify__c}>
                                                                            <lightning-input type="checkbox"  name="review.Verify__c" value={review.Verify__c} label="" data-field={index} onchange={handleFieldChange} if:false={isReadMode}></lightning-input>
                                                                        </template> 
                                                                        <!--readonly-->
                                                                        <div class="slds-form-element" if:true={isReadMode}>
                                                                            <template if:false={review.Verify__c}>
                                                                                <lightning-input type="checkbox" disabled> </lightning-input>
                                                                            </template>
                                                                            <template if:true={review.Verify__c}>
                                                                                <lightning-input type="checkbox" disabled checked> </lightning-input>
                                                                            </template>
                                                                        </div>
                                                                    </lightning-layout-item>
                                                                </td>
                                                                <td class=" slds-col slds-grow-none slds-hidden">
                                                                    <lightning-layout-item  padding="around-none">
                                                                        <lightning-input name="review.Review_Checklist_Type__c" class="Review_Checklist_Type__c"
                                                                        value={review.Review_Checklist_Type__c} disabled type="text" label=""
                                                                        data-field={index}></lightning-input> 
                                                                    </lightning-layout-item>                                                                     
                                                                </td>                                                            
                                                            </tr>
                                                        </template>
                                                    </template>
                                                </tbody>
                                            </table>
                                        </div>
                                    </lightning-layout-item>   
                                </template>
                            </lightning-layout>

                            <template if:false={isDefaultChecklist}>
                                <lightning-layout>
                                    <lightning-layout-item padding="around-small" size="12">
                                        <h3> <b>Documents:</b></h3>
                                        <table class="slds-table slds-table_cell-buffer slds-table_bordered">
                                            <thead>
                                                <tr class="slds-line-height_reset">
                                                    <th class="slds-col slds-grow-none" scope="col">
                                                    </th>
                                                    <th class="slds-size_3-of-12" scope="col">
                                                        <div>Review Type</div>
                                                    </th>
                                                    <th class="slds-size_7-of-12" scope="col">
                                                        <div>Audited Info</div>
                                                    </th>
                                                    <th class="slds-size_2-of-12" scope="col">
                                                        <div>Verify</div>
                                                    </th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <template for:each={lstDocuments}
                                                    for:item="document" for:index="index">
                                                    <tr class="slds-line-height_reset" key={document.Review_Checklist_Type__c}>
                                                        <td class="slds-col slds-grow-none">
                                                            <lightning-layout-item padding="around-none">
                                                                <lightning-icon icon-name="utility:info" size="x-small" alternative-text={document.Help_Text__c} title={document.Help_Text__c}></lightning-icon>
                                                            </lightning-layout-item>                                                                     
                                                        </td>
                                                        <td class="slds-size_3-of-12">
                                                            <lightning-layout-item padding="around-none">
                                                                <div class="slds-form-element" if:false={isReadMode}>
                                                                    <lightning-input name={document.Review_Checklist_Type__c} value={document.Review_Checklist_Type__c} 
                                                                        disabled type="text" label="" data-field={index} if:false={isReadMode}>                                                                
                                                                    </lightning-input>
                                                                </div>
                                                                <!-- <lightning-layout-item padding="around-none">
                                                                    <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon_left" if:false={isReadMode}>
                                                                        <lightning-icon icon-name="utility:info" size="x-small" alternative-text={document.Help_Text__c} title={document.Help_Text__c}></lightning-icon>
                                                                        <lightning-input name={document.Review_Checklist_Type__c} value={document.Review_Checklist_Type__c} 
                                                                            disabled type="text" label="" data-field={index} if:false={isReadMode}>                                                                
                                                                        </lightning-input>
                                                                    </div> -->
                                                                <!--readonly-->
                                                                <div class="slds-form-element" if:true={isReadMode}>
                                                                    <div class="slds-form-element__control">
                                                                        {document.Review_Checklist_Type__c}
                                                                        <!-- <lightning-icon icon-name="utility:info" size="x-small" alternative-text="complete &amp; fully executed" title="complete &amp; fully executed"></lightning-icon> -->
                                                                    </div>
                                                                </div>
                                                            </lightning-layout-item>                                                                     
                                                        </td>
                                                        <td class="slds-size_7-of-12">
                                                            <lightning-layout-item padding="around-none">
                                                                <lightning-input name="document.TC_Updates__c" value={document.TC_Updates__c}
                                                                type="text" label="" data-field={index} onchange={handleFieldChange}  
                                                                if:false={isReadMode}></lightning-input>
                                                                <!--readonly-->
                                                                <div class="slds-form-element" if:true={isReadMode}>
                                                                    <div class="slds-form-element__control">
                                                                        {document.TC_Updates__c}
                                                                    </div>
                                                                </div>
                                                            </lightning-layout-item>                                                                    
                                                        </td>	
                                                        <td class="slds-size_2-of-12">
                                                            <!-- Verify -->
                                                            <lightning-layout-item padding="around-none">
                                                                <template if:true={document.Verify__c}>
                                                                    <lightning-input type="checkbox" name="document.Verify__c" value={document.Verify__c} label="" checked data-field={index} onchange={handleFieldChange} if:false={isReadMode}></lightning-input>
                                                                </template>
                                                                <template if:false={document.Verify__c}>
                                                                    <lightning-input type="checkbox"  name="document.Verify__c" value={document.Verify__c} label="" data-field={index} onchange={handleFieldChange} if:false={isReadMode}></lightning-input>
                                                                </template> 
                                                                <!--readonly-->
                                                                <div class="slds-form-element" if:true={isReadMode}>
                                                                    <template if:false={document.Verify__c}>
                                                                        <lightning-input type="checkbox" disabled> </lightning-input>
                                                                    </template>
                                                                    <template if:true={document.Verify__c}>
                                                                        <lightning-input type="checkbox" disabled checked> </lightning-input>
                                                                    </template>
                                                                </div>
                                                            </lightning-layout-item>
                                                        </td>
                                                    </tr>
                                                </template>
                                            </tbody>
                                        </table>
                                    </lightning-layout-item>        
                                </lightning-layout>                            
                            </template>
                            
                                <!-- Inspection Section -->
                                <lightning-accordion-section name="Inspection_Details" label="Inspection Details">
                                    <lightning-layout>

                                        <lightning-layout-item padding="around-small" size="12">
                                            <div>
                                                <table class="slds-table slds-table_cell-buffer slds-table_bordered">
                                                    <thead>
                                                        <tr class="slds-line-height_reset">
                                                            <th class="" scope="col">
                                                                <div>Property Unit</div>
                                                            </th>
                                                            <th class="" scope="col">
                                                                <div>Occupancy</div>
                                                            </th>
                                                            <th class="" scope="col">
                                                                <div>Access Type</div>
                                                            </th>
                                                            <th class="" scope="col">
                                                                <div>Access Note</div>
                                                            </th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <template for:each={contractQCWrapper.propertyUnitList}
                                                            for:item="propertyUnit" for:index="index">
                                                            <tr class="slds-line-height_reset" key={propertyUnit.Id}>
                                                                <td>
                                                                    <!-- Property Unit -->
                                                                    <lightning-layout-item size="2"
                                                                        padding="around-none">
                                                                        <lightning-input name="Name" if:false={isReadMode} data-field={index}
                                                                            label="Name" variant="label-hidden"
                                                                            value={propertyUnit.Name}>
                                                                        </lightning-input>
                                                                        <!--readonly-->
                                                                        <div class="slds-form-element" if:true={isReadMode}>
                                                                            <div class="slds-form-element__control">
                                                                                {propertyUnit.Name}
                                                                            </div>
                                                                        </div>
                                                                    </lightning-layout-item>                                                                     
                                                                </td>
                                                                <td>
                                                                    <!-- Occupancy -->
                                                                    <!-- <lightning-layout-item size="3"
                                                                        padding="around-none">
                                                                        <template if:false={isReadMode}>
                                                                            <lightning-combobox
                                                                                name="Occupancy_at_Closing__c"
                                                                                data-field={index}
                                                                                variant="label-hidden"
                                                                                value={propertyUnit.Occupancy_at_Closing__c}
                                                                                placeholder="Select Occupancy"
                                                                                options={occupancyPicklistValues}
                                                                                onchange={handleFieldChange}
                                                                                readonly={isReadMode}>
                                                                            </lightning-combobox>
                                                                        </template>
                                                                        <template if:true={isReadMode}>
                                                                            <lightning-input
                                                                                name="Occupancy_at_Closing__c.readonly"
                                                                                data-field="index.readonly"
                                                                                value={propertyUnit.Occupancy_at_Closing__c}
                                                                                readonly>
                                                                            </lightning-input>
                                                                        </template>
                                                                    </lightning-layout-item> -->
                                                                    <lightning-layout-item size="3"
                                                                        padding="around-none">
                                                                        <!--readonly-->
                                                                        <div class="slds-form-element">
                                                                            <div class="slds-form-element__control">
                                                                                <div class="property_occupancy">{propertyUnit.Occupancy_at_Closing__c}</div>
                                                                            </div>
                                                                        </div>		
                                                                    </lightning-layout-item>                                                                    
                                                                </td>
                                                                <td>
                                                                    <!-- Access Type -->
                                                                    <!-- <lightning-layout-item size="3"
                                                                        padding="around-none">
                                                                        <template if:false={isReadMode}>
                                                                            <lightning-combobox
                                                                                name="Property_Access_Method_Type__c"
                                                                                data-field={index}
                                                                                variant="label-hidden"
                                                                                value={propertyUnit.Property_Access_Method_Type__c}
                                                                                placeholder="Select Access Type"
                                                                                options={propertyAccessMethodPicklistValues}
                                                                                onchange={handleFieldChange}
                                                                                readonly={isReadMode}>
                                                                            </lightning-combobox>
                                                                        </template>
                                                                        <template if:true={isReadMode}>
                                                                            <lightning-input
                                                                                name="Property_Access_Method_Type__c.readonly"
                                                                                data-field="index.readonly"
                                                                                value={propertyUnit.Property_Access_Method_Type__c}
                                                                                readonly>
                                                                            </lightning-input>
                                                                        </template>
                                                                    </lightning-layout-item> -->
                                                                    <lightning-layout-item size="3"
                                                                        padding="around-none">
                                                                        <lightning-combobox
                                                                            name="Property_Access_Method_Type__c"
                                                                            if:false={isReadMode}
                                                                            data-field={index}
                                                                            variant="label-hidden"
                                                                            value={propertyUnit.Property_Access_Method_Type__c}
                                                                            placeholder="Select Access Type"
                                                                            options={propertyAccessMethodPicklistValues}
                                                                            onchange={handleFieldChange}>
                                                                        </lightning-combobox>
                                                                        <!--readonly-->
                                                                        <div class="slds-form-element" if:true={isReadMode}>
                                                                            <div class="slds-form-element__control">
                                                                                {propertyUnit.Property_Access_Method_Type__c}
                                                                            </div>
                                                                        </div>
                                                                    </lightning-layout-item>                                                                    
                                                                </td>
                                                                <td>
                                                                    <!-- Access Note -->
                                                                    <lightning-layout-item size="4"
                                                                        padding="around-none">
                                                                        <lightning-input name="Property_Access_Notes__c"
                                                                            data-field={index} type="textarea"
                                                                            label="Access Note" variant="label-hidden"
                                                                            value={propertyUnit.Property_Access_Notes__c}
                                                                            title={propertyUnit.Property_Access_Notes__c}
                                                                            onchange={handleFieldChange}
                                                                            readonly={isReadMode}>
                                                                        </lightning-input>
                                                                    </lightning-layout-item>
                                                                </td>
                                                            </tr>
                                                        </template>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </lightning-layout-item>
                                    </lightning-layout>
                                </lightning-accordion-section>                                

                                <!-- Email Communication -->
                                <lightning-accordion-section name="Email_Communication" label="Email communication">
                                    <!-- <h3><b>Email Communication</b></h3>                                     -->
                                    <lightning-layout multiple-rows>

                                        <!-- Inspection Needed -->
                                        <lightning-layout-item size="4" padding="horizontal-medium">
                                            <lightning-combobox name="Inspection_Needed__c"
                                                data-field="transactionRecord.Inspection_Needed__c"
                                                label="Inspection Needed"
                                                value={contractQCWrapper.transactionRecord.Inspection_Needed__c}
                                                placeholder="Select Inspection Needed"
                                                options={inspectionNeededPicklistValues}
                                                onchange={handleFieldChange} if:false={isReadMode}>
                                            </lightning-combobox>
                                            <!--readonly-->
                                            <div class="slds-form-element" if:true={isReadMode}>
                                                <span class="slds-form-element__label">Inspection Needed</span>
                                                <div class="slds-form-element__control slds-has-divider--bottom">
                                                    {contractQCWrapper.transactionRecord.Inspection_Needed__c}
                                                </div>
                                            </div>
                                        </lightning-layout-item>
                                        <lightning-layout-item size="8" padding="horizontal-medium">
                                        </lightning-layout-item>

                                        <!-- Open Escrow -->
                                        <lightning-layout-item size="4" padding="horizontal-medium">
                                            <lightning-combobox name="Open_Escrow__c"
                                                data-field="transactionRecord.Open_Escrow__c"
                                                label="Open Escrow"
                                                value={contractQCWrapper.transactionRecord.Open_Escrow__c}
                                                placeholder="Select Open Escrow"
                                                options={openEscrowPickList}
                                                onchange={handleFieldChange} if:false={isReadMode}>
                                            </lightning-combobox>
                                            <!--readonly-->
                                            <div class="slds-form-element" if:true={isReadMode}>
                                                <span class="slds-form-element__label">Open Escrow</span>
                                                <div class="slds-form-element__control slds-has-divider--bottom">
                                                    {contractQCWrapper.transactionRecord.Open_Escrow__c}
                                                </div>
                                            </div>
                                        </lightning-layout-item>
                                        <lightning-layout-item size="8" padding="horizontal-medium">
                                        </lightning-layout-item>

                                    </lightning-layout>
                                </lightning-accordion-section>
                                
                              
                                <!-- System Information -->
                                <lightning-accordion-section name="System_Information" label="System Information">

                                    <lightning-layout multiple-rows>
                                        <!-- Due Date -->
                                        <!-- <lightning-layout-item size="4" padding="horizontal-medium">
                                            <lightning-input name="ActivityDate" data-field="task.ActivityDate"
                                                label="Due Date" value={contractQCWrapper.task.ActivityDate} readonly>
                                            </lightning-input>
                                             <hr style="display:block; margin-top:0.25em; margin-bottom:0.25em;">
                                            
                                        </lightning-layout-item> -->
                                         <!-- Due Date -->
                                        <lightning-layout-item size="4" padding="horizontal-medium">
                                            <div class="slds-form-element">
                                                <span class="slds-form-element__label">Due Date</span>
                                                <div class="slds-form-element__control slds-has-divider--bottom">
                         <lightning-formatted-date-time value={contractQCWrapper.task.ActivityDate} year="numeric" month="numeric" day="numeric" time-zone="UTC"></lightning-formatted-date-time>                                                        
                                                </div>
                                            </div>
                                        </lightning-layout-item>
                                        <!-- Created On -->
                                        <!-- <lightning-layout-item size="4" padding="horizontal-medium">
                                            <lightning-input name="ActivityCreatedDateTime__c"
                                                data-field="task.ActivityCreatedDateTime__c" label="Create On"
                                                value={contractQCWrapper.task.ActivityCreatedDateTime__c} readonly>
                                            </lightning-input>
                                            <hr style="display:block; margin-top:0.25em; margin-bottom:0.25em;">
                                        </lightning-layout-item> -->
                                        <lightning-layout-item size="4" padding="horizontal-medium">
                                            <div class="slds-form-element">
                                                <span class="slds-form-element__label">Create On</span>
                                                <div class="slds-form-element__control slds-has-divider--bottom">
                                                    <lightning-formatted-date-time value={contractQCWrapper.task.ActivityCreatedDateTime__c} year="numeric" month="numeric" day="numeric" hour="2-digit" minute="2-digit" hour12="false"></lightning-formatted-date-time>
                                                </div>
                                            </div>
                                        </lightning-layout-item>
                                        <!-- Owner -->
                                        <lightning-layout-item size="4" padding="horizontal-medium">
                                            <c-custom-lookup-lwc icon-name="standard:user" name="OwnerId"
                                                data-field="task.OwnerId"
                                                s-object-api-name="user" label="Owner"
                                                onlookupupdate={lookupRecord}
                                                default-record-id={contractQCWrapper.task.OwnerId}
                                                placeholder="type here..." if:false={isReadMode}>
                                            </c-custom-lookup-lwc>
                                            <!--readonly-->
                                            <div class="slds-form-element" if:true={isReadMode}>
                                                <span class="slds-form-element__label">Owner</span>
                                                <div class="slds-form-element__control slds-has-divider--bottom">
                                                    {contractQCWrapper.task.Owner_Stamp__c}
                                                </div>
                                            </div>                        
                                        </lightning-layout-item>

                                        <!-- Assigned On -->
                                        <!-- <lightning-layout-item size="4" padding="horizontal-medium">
                                            <lightning-input name="Assigned_On__c" data-field="task.Assigned_On__c"
                                                label="Assigned On" value={contractQCWrapper.task.Assigned_On__c}
                                                readonly>
                                            </lightning-input>
                                            <hr style="display:block; margin-top:0.25em; margin-bottom:0.25em;">
                                        </lightning-layout-item> -->
                                        <lightning-layout-item size="4" padding="horizontal-medium">
                                            <div class="slds-form-element">
                                                <span class="slds-form-element__label">Assigned On</span>
                                                <div class="slds-form-element__control slds-has-divider--bottom">
                                                    <lightning-formatted-date-time value={contractQCWrapper.task.Assigned_On__c} year="numeric" month="numeric" day="numeric" hour="2-digit" 
                                                    minute="2-digit"  hour12="false"></lightning-formatted-date-time>                                                        
                                                </div>
                                            </div>
                                        </lightning-layout-item>
                                        <!-- New Status -->                                       
                                        <lightning-layout-item size="4" padding="horizontal-medium">
                                            <!-- <lightning-combobox name="Status" data-field="task.Status"
                                                label="New Status" value={contractQCWrapper.task.Status}
                                                placeholder="Select New Task Status"
                                                options={taskStatusPicklistValues} onchange={handleFieldChange} if:false={isReadMode}>
                                            </lightning-combobox> -->
                                            <!--readonly-->
                                            <div class="slds-form-element">
                                                <span class="slds-form-element__label">New Status</span>
                                                <div class="slds-form-element__control slds-has-divider--bottom">
                                                    {contractQCWrapper.task.Status}
                                                </div>
                                            </div>
                                        </lightning-layout-item>
                                        <!-- Completed On -->                                        
                                        <lightning-layout-item size="4" padding="horizontal-medium">
                                            <div class="slds-form-element">
                                                <span class="slds-form-element__label">Completed On</span>
                                                <div class="slds-form-element__control slds-has-divider--bottom">
                                                    <lightning-formatted-date-time value={contractQCWrapper.task.CompletedDateTime} year="numeric" month="numeric" day="numeric" hour="2-digit" 
                                                    minute="2-digit"  hour12="false"></lightning-formatted-date-time>                                                        
                                                </div>
                                            </div>
                                        </lightning-layout-item>
                                        <!-- Notes -->                                        
                                        <lightning-layout-item size="12" padding="horizontal-medium">
                                            <lightning-input name="Description" if:false={isReadMode} data-field="task.Description"
                                                type="textarea" label="Notes"
                                                value={contractQCWrapper.task.Description}>
                                            </lightning-input>
                                            <!--readonly-->
                                            <div class="slds-form-element" if:true={isReadMode}>
                                                <span class="slds-form-element__label">Notes</span>
                                                <div class="slds-form-element__control slds-has-divider--bottom">
                                                        {contractQCWrapper.task.Description}
                                                </div>
                                            </div>
                                        </lightning-layout-item>

                                    </lightning-layout>

                                </lightning-accordion-section>

                            </lightning-accordion>

                        </template>

                        <template if:true={isSubmitEMD}>
                            <c-submit-e-m-d record-id={recordId}></c-submit-e-m-d>
                        </template> 

                    </lightning-tab>
                </template>
                <!-- <template if:true={isSubmitEMD}>
                    <lightning-tab label="Submit EMD Upload Request" value="Submit EMD Upload Request"
                        onactive={handleTypeChange}>
                        <c-submit-e-m-d record-id={recordId}></c-submit-e-m-d>
                    </lightning-tab>
                </template>  -->
            </lightning-tabset>
        </div>

    </template>
</template>